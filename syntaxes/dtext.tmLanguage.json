{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "DText (e621)",
	"patterns": [
		{ "include": "#markup" },
		{ "include": "#meta" }
	],
	"repository": {
		"markup": {
			"patterns": [
				{
					"name": "markup.inline.raw.code.dtext",
					"match": "(`)[^`]*(`)",
					"captures": {
						"1" : { "name": "punctuation.definition.raw.dtext" },
						"2" : { "name": "punctuation.definition.raw.dtext" }
					}
				},
				{
					"name": "meta.tag.markup.bold",
					"contentName": "markup.bold.dtext",
					"begin": "((\\[)(b)(\\]))",
					"beginCaptures": {
						"1": { "name": "entity.name.tag.start" },
						"2": { "name": "punctuation.definition.tag.begin.dtext" },
						"3": { "name": "entity.name.tag.name" },
						"5": { "name": "punctuation.definition.tag.end.dtext" }
					},
					"end": "((\\[/)(\\3)(\\]))",
					"endCaptures": {
						"1": { "name": "entity.name.tag.end" },
						"2": { "name": "punctuation.definition.tag.begin.dtext" },
						"3": { "name": "entity.name.tag.name" },
						"5": { "name": "punctuation.definition.tag.end.dtext" }
					},
					"patterns": [
						{ "include": "#markup" },
						{ "include": "#meta" }
					]
				},
				{
					"name": "meta.tag.markup.italic",
					"contentName": "markup.italic.dtext",
					"begin": "((\\[)(i)(\\]))",
					"beginCaptures": {
						"1": { "name": "entity.name.tag.start" },
						"2": { "name": "punctuation.definition.tag.begin.dtext" },
						"3": { "name": "entity.name.tag.name" },
						"5": { "name": "punctuation.definition.tag.end.dtext" }
					},
					"end": "((\\[/)(\\3)(\\]))",
					"endCaptures": {
						"1": { "name": "entity.name.tag.end" },
						"2": { "name": "punctuation.definition.tag.begin.dtext" },
						"3": { "name": "entity.name.tag.name" },
						"5": { "name": "punctuation.definition.tag.end.dtext" }
					},
					"patterns": [
						{ "include": "#markup" },
						{ "include": "#meta" }
					]
				},
				{
					"name": "meta.tag.markup.subscript",
					"contentName": "markup.subscript.dtext",
					"begin": "((\\[)(sub)(\\]))",
					"beginCaptures": {
						"1": { "name": "entity.name.tag.start" },
						"2": { "name": "punctuation.definition.tag.begin.dtext" },
						"3": { "name": "entity.name.tag.name" },
						"5": { "name": "punctuation.definition.tag.end.dtext" }
					},
					"end": "((\\[/)(\\3)(\\]))",
					"endCaptures": {
						"1": { "name": "entity.name.tag.end" },
						"2": { "name": "punctuation.definition.tag.begin.dtext" },
						"3": { "name": "entity.name.tag.name" },
						"5": { "name": "punctuation.definition.tag.end.dtext" }
					},
					"patterns": [
						{ "include": "#markup" },
						{ "include": "#meta" }
					]
				},
				{
					"name": "meta.tag.markup.superscript",
					"contentName": "markup.superscript.dtext",
					"begin": "((\\[)(sup)(\\]))",
					"beginCaptures": {
						"1": { "name": "entity.name.tag.start" },
						"2": { "name": "punctuation.definition.tag.begin.dtext" },
						"3": { "name": "entity.name.tag.name" },
						"5": { "name": "punctuation.definition.tag.end.dtext" }
					},
					"end": "((\\[/)(\\3)(\\]))",
					"endCaptures": {
						"1": { "name": "entity.name.tag.end" },
						"2": { "name": "punctuation.definition.tag.begin.dtext" },
						"3": { "name": "entity.name.tag.name" },
						"5": { "name": "punctuation.definition.tag.end.dtext" }
					},
					"patterns": [
						{ "include": "#markup" },
						{ "include": "#meta" }
					]
				},
				{
					"name": "meta.tag.markup.strikethrough",
					"contentName": "markup.strikethrough.dtext",
					"begin": "((\\[)(s)(\\]))",
					"beginCaptures": {
						"1": { "name": "entity.name.tag.start" },
						"2": { "name": "punctuation.definition.tag.begin.dtext" },
						"3": { "name": "entity.name.tag.name" },
						"5": { "name": "punctuation.definition.tag.end.dtext" }
					},
					"end": "((\\[/)(\\3)(\\]))",
					"endCaptures": {
						"1": { "name": "entity.name.tag.end" },
						"2": { "name": "punctuation.definition.tag.begin.dtext" },
						"3": { "name": "entity.name.tag.name" },
						"5": { "name": "punctuation.definition.tag.end.dtext" }
					},
					"patterns": [
						{ "include": "#markup" },
						{ "include": "#meta" }
					]
				}
			]
		},
		"meta": {
			"patterns": [
				{
					"name": "meta.tag",
					"contentName": "meta.tag.body",
					"begin": "(?<!\\[)((\\[)([a-zA-Z0-9]+)([^\\]]*)(\\]))",
					"beginCaptures": {
						"1": { "name": "entity.name.tag.start" },
						"2": { "name": "punctuation.definition.tag.begin.dtext" },
						"3": { "name": "entity.name.tag.name" },
						"4": { "name": "" },
						"5": { "name": "punctuation.definition.tag.end.dtext" }
					},
					"end": "(?<!\\[)((\\[/)(\\3)([^\\]]*)(\\]))",
					"endCaptures": {
						"1": { "name": "entity.name.tag.end" },
						"2": { "name": "punctuation.definition.tag.begin.dtext" },
						"3": { "name": "entity.name.tag.name" },
						"4": { "name": "" },
						"5": { "name": "punctuation.definition.tag.end.dtext" }
					},
					"patterns": [
						{ "include": "#markup" },
						{ "include": "#meta" }
					]
				},
				{
					"name": "meta.link.reference.dtext",
					"match": "((\\[)(\\#[- a-zA-Z0-9]+)(\\]))",
					"captures": {
						"1": { "name": "" },
						"2": { "name": "punctuation.definition.link.title.begin.dtext" },
						"3": { "name": "string.other.link.title.dtext" },
						"4": { "name": "punctuation.definition.link.title.end.dtext" }
					}
				},
				{
					"name": "meta.link.inline.dtext",
					"match": "((\\[\\[)([^\\]|]+)(?:\\|([^\\]]+))?(\\]))",
					"captures": {
						"1": { "name": "" },
						"2": { "name": "punctuation.definition.link.title.begin.dtext" },
						"3": { "name": "markup.underline.link.dtext" },
						"4": { "name": "string.other.link.title.dtext" },
						"5": { "name": "punctuation.definition.link.title.end.dtext" }
					}
				},
				{
					"name": "meta.link.inline.dtext",
					"match": "((\")([^\"]*)(\"))(:)(\\[[^\\]]*\\]|\\S*)",
					"captures": {
						"1": { "name": "string.other.link.title.dtext" },
						"2": { "name": "punctuation.definition.link.title.begin.dtext" },
						"3": { "name": "" },
						"4": { "name": "punctuation.definition.link.title.end.dtext" },
						"5": { "name": "entity.name.link.start" },
						"6": { "name": "" },
						"7": { "name": "markup.underline.link.dtext" }
					}
				},
				{
					"name": "meta.link.inline.tag-search.dtext",
					"match": "((\\{\\{)([^}]+)(\\}\\}))",
					"captures": {
						"1": { "name": "string.other.link.title.dtext" },
						"2": { "name": "punctuation.definition.link.title.begin.dtext" },
						"3": { "name": "markup.underline.link.tag-search.dtext" },
						"4": { "name": "punctuation.definition.link.title.end.dtext" }
					}
				}
			]
		}
	},
	"scopeName": "source.dtext"
}